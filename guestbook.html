<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Showza — Guestbook</title>
  <link rel="stylesheet" href="styles.css">
  <script src="nav.js" defer></script>
  <link rel="icon" type="image/png" href="assets/favicon.png">
  <link rel="shortcut icon" href="assets/favicon.png">
  <meta name="viewport" content="width=device-width,initial-scale=1">
</head>
<body bgcolor="#000000" text="#ffff00" link="#97e6d1" vlink="#ffffff">
<center>
  <img src="assets/banner.png" alt="Showza" width="640" style="border: 1px solid #97e6d1;"
      srcset="assets/banner.png 640w, assets/banner.png 320w"
      sizes="(max-width:640px) 100vw, 640px">
    <img src="assets/showza fire logo.gif" width="202" height="96" alt="Showza" /></a>
    <nav class="navbar">
      <button class="hamburger" aria-label="Menu" aria-expanded="false">☰</button>
      <div class="nav-links" id="main-nav">
        <a class="nav" href="index.html">HOME</a>
        <a class="nav" href="gigs.html">GIGS</a>
        <a class="nav" href="music.html">MUSIC</a>
        <a class="nav" href="watch.html">WATCH</a>
        <a class="nav" href="merch.html">MERCH</a>
        <a class="nav" href="contact.html">CONTACT</a>
      </div>
    </nav>
  <img src="assets/guestbook logo.png" alt="Guestbook" width="250" style="margin-top:12px;">
  <p class="tag">leave us a message</p>

  <hr class="kitt">

  <form id="guestform" style="max-width:640px;text-align:left;">
    <label>Name:<br><input id="name" name="name" maxlength="100" style="width:100%;padding:6px;margin-bottom:6px;"></label>
    <label>Message:<br><textarea id="message" name="message" rows="4" maxlength="1000" style="width:100%;padding:6px;margin-bottom:6px;"></textarea></label>
    <div style="text-align:right;"><button class="retro-btn" type="submit">Sign Guestbook</button></div>
  </form>

  <hr class="kitt">

  <div id="entries" style="max-width:700px;text-align:left;"></div>

  <p style="margin-top:18px;"><a href="index.html" class="nav">Back</a></p>
  <p style="font-size:12px;color:#97e6d1;">This site was made in 2026. The SICK animated text is from CoolText.com.</p>
    <a href="http://cooltext.com" target="_blank"><img src="https://cooltext.com/images/ct_button.gif"  width="88" height="31" alt="Cool Text: Logo and Graphics Generator" /></a>
</center>

<script>
function escapeHtml(s){return s.replace(/[&<>"']/g,function(c){return{'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":"&#39;"}[c];});}
async function loadEntries(){
  const res = await fetch('/guestbook/entries');
  const data = await res.json();
  const container = document.getElementById('entries');
  if(!data.length){container.innerHTML='<p class="tag">No entries yet — be the first!</p>';return}
  container.innerHTML = data.map(e=>{
    return `<div class="guest-entry" style="border:1px solid var(--mint);padding:8px;margin:8px 0;background:var(--panel);color:var(--mint-text);"><strong>${escapeHtml(e.name)}</strong> <span style="color:#888;font-size:12px;">${new Date(e.time).toLocaleString()}</span><div style="margin-top:6px;">${escapeHtml(e.message)}</div></div>`
  }).join('');
}
document.getElementById('guestform').addEventListener('submit', async function(ev){
  ev.preventDefault();
  const name = document.getElementById('name').value||'Anon';
  const message = document.getElementById('message').value||'';
  if(!message.trim()) return alert('Please enter a message.');
  const res = await fetch('/guestbook/entries',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({name,message})});
  if(res.ok){document.getElementById('name').value='';document.getElementById('message').value='';loadEntries();}else{alert('Error saving entry.');}
});
loadEntries();
</script>
</body>
</html>
